# å¼‚æ­¥ç¼–ç¨‹
# Rxswiftå“åº”å¼ç¼–ç¨‹
Rxswiftæ˜¯ä¸€å¥—è§£å†³å¼‚æ­¥ç¼–ç¨‹é—®é¢˜çš„APIï¼Œä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼å’Œè¿­ä»£å­æ¨¡å¼ï¼ŒåŸºäºå‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ã€‚
è®¾è®¡æ¨¡å¼çš„ç»¼åˆè¿ç”¨ï¼šObserverã€Builderã€Iterator

## è§‚å¯Ÿè€…æ¨¡å¼
![](media/16303768029798/16389540861586.png)
RxSwiftå¯¹åº”è§’è‰²ï¼š
Subject -> BehaviorSubject
observerCollection -> observers
registerObserver -> subscribe
unregisterObserver -> synchronizedUnsubscribe
notifyObservers -> on(event:)
Observer -> AnonymousObserver

## å»ºé€ è€…æ¨¡å¼
![](media/16303768029798/16389545235762.png)
RxSwiftå¯¹åº”è§’è‰²ï¼š
Product -> Producerï¼ˆOperatoråŸºç±»ï¼‰
ObservableType extensions -> Director
ConcreteBuilder -> åˆ›å»ºå‹ï¼ˆCreateã€Deferã€Fromï¼‰ã€å˜æ¢å‹ï¼ˆBufferã€Mapã€GroupByï¼‰ã€è¿‡æ»¤å‹ï¼ˆFilterã€Takeï¼‰ã€å…³è”å‹ï¼ˆAndã€Joinã€Mergeï¼‰ç­‰ç­‰
é€šè¿‡ç‚¹è¯­æ³•å»ºé€ Obserable
```
Observable.repeatElement("ğŸ”´")
          .take(3)
```



## å…³é”®ç±»ï¼š
åŸºæœ¬ç±»å‹å®šä¹‰ï¼š
ObservableType å¯ç›‘å¬ç±»å‹
SchedulerType  è°ƒåº¦å™¨ç±»å‹
ObserverType   è§‚å¯Ÿè€…ç±»å‹
Disposable     å¯è§£é™¤ç›‘å¬/è®¢é˜…ç±»å‹

### å…³é”®ç±»ï¼šOperators
ä½œç”¨ï¼šé“¾æ¥æ“ä½œï¼Œé“¾ä¸­çš„æ¯ä¸ªOperatoréƒ½ä¼šä¿®æ”¹ç”±å‰ä¸€ä¸ªOperatoräº§ç”Ÿçš„Observableã€‚ç±»ä¼¼å»ºé€ è€…æ¨¡å¼ï¼Œå»ºé€ ä¸€ä¸ªç¬¦åˆéœ€æ±‚çš„Observableã€‚

#### è¿ç®—ç¬¦åˆ†ç±»
è¿ç®—ç¬¦åˆ†ç±»ï¼šhttp://reactivex.io/documentation/operators.html#categorized

#### å¦‚ä½•é€‰æ‹©æ°å½“çš„Operatorï¼Ÿ
è¿ç®—ç¬¦å†³ç­–æ ‘ï¼šhttp://reactivex.io/documentation/operators.html#categorized

#### Sink
RxSwiftæ¯ä¸ªOperatoréƒ½æœ‰å¯¹åº”çš„Sinkå­ç±»ï¼Œå…¶åŠŸèƒ½ä¸ºè®¢é˜…ä¿¡å·æºæ—¶ç»™ObservableTypeã€SchedulerTypeã€ObserverTypeã€Disposable 4ä¸ªå¯¹è±¡æ„å»ºä¾èµ–å…³ç³»ã€‚

åˆ›å»ºå‹Operatorç»‘å®šçš„é€»è¾‘æ¡ˆä¾‹ï¼š
```
/// RepeatElement Operatoræ„å»ºä¾èµ–
override func run<Observer: ObserverType>(_ observer: Observer, cancel: Cancelable) -> (sink: Disposable, subscription: Disposable) where Observer.Element == Element {
        let sink = RepeatElementSink(parent: self, observer: observer, cancel: cancel)
        let subscription = sink.run() // ç»‘å®š

        return (sink: sink, subscription: subscription)
    }
    
/// RepeatElementSinkè¿ç®—ç¬¦è°ƒåº¦é€»è¾‘
func run() -> Disposable {
        return self.parent.scheduler.scheduleRecursive(self.parent.element) { e, recurse in
            self.forwardOn(.next(e))
            recurse(e)
        }
    }
```

è½¬æ¢å‹Operatoræ¡ˆä¾‹ï¼š
```
/// GroupBy Operatoræ„å»ºä¾èµ–
override func run<Observer: ObserverType>(_ observer: Observer, cancel: Cancelable) -> (sink: Disposable, subscription: Disposable) where Observer.Element == GroupedObservable<Key,Element> {
        let sink = GroupBySink(parent: self, observer: observer, cancel: cancel)
        return (sink: sink, subscription: sink.run())
    }
    
func run() -> Disposable {
        self.refCountDisposable = RefCountDisposable(disposable: self.subscription)
        
        self.subscription.setDisposable(self.parent.source.subscribe(self))
        
        return self.refCountDisposable
    }
```



Operators
Single
Subject
Scheduler



# PromiseKit